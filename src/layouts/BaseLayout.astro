---
import BaseHead from "@/components/BaseHead.astro";
import Navigation from "@/components/global/Navigation.astro";
import Footer from "@/components/global/Footer.astro";
import { isAuthenticated, getUserFromCookies } from "@/utils/auth";

const isLoggedIn = isAuthenticated(Astro.cookies);
const user = isLoggedIn ? await getUserFromCookies(Astro.cookies, Astro.redirect) : null;
---

<html lang="en">  
  <head>   
    <BaseHead />
  </head>
  <body class=`flex flex-col min-h-screen px-4 sm:px-6 md:px-8 mx-auto bg-white`>
    <Navigation isLoggedIn={isLoggedIn} user={user} /> 
    <main class="flex-grow">
      <slot />
    </main>
    <Footer />
  </body>

  <script is:inline>
    if ("paintWorklet" in CSS) {
      CSS.paintWorklet.addModule(
        "https://www.unpkg.com/css-houdini-squircle/squircle.min.js"
      );
    }
  </script>
</html>
  