---
import { generateResponsiveImages, getBlogEntrySizes } from "@/utils/image-optimizer";

interface Props {
  title: string;
  description: string;
  image: string;
  url: string;
  id?: number;
}

const { title, description, image, url, id } = Astro.props;

const responsiveImageData = generateResponsiveImages({
  src: image,
  width: 1200,
  quality: 85,
  sizes: getBlogEntrySizes()
});
---

<article class="flex flex-col flex-1 h-full group">
  <a 
    href={url} 
    target="_blank" 
    rel="noopener noreferrer" 
    title={title} 
    class="block"
    onclick={id ? `fetch('/api/admin/sponsor-banners/track-click', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ id: ${id} }) }).catch(e => console.error(e))` : undefined}
  >
    <div class="block w-full">
      <img
        width={1200}
        height={630}
        src={responsiveImageData.src}
        srcset={responsiveImageData.srcset}
        sizes={responsiveImageData.sizes}
        alt={title}
        loading="lazy"
        decoding="async"
        class="object-cover w-full h-full bg-center aspect-12/8 rounded-xl"
      />
    </div>
  </a>

  <div class="mt-3 sm:mt-5">
    <div class="flex items-center gap-1 text-xs text-rose-600 font-medium mb-2">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
        <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" />
      </svg>
      <span>Sponsorlu</span>
    </div>

    <h3 class="text-base text-base-900 text-balance">
      <a href={url} target="_blank" rel="noopener noreferrer" class="group-hover:underline group-hover:decoration-1 group-hover:decoration-wavy">
        {title}
      </a>
    </h3>

    <p class="mt-1 text-sm text-base-500 line-clamp-2">{description}</p>
  </div>
</article>
